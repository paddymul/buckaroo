import{l as i}from"./lodash-CGIzQN7T.js";import{j as R}from"./jsx-runtime-DiklIkkE.js";import{r as p}from"./index-DRjF_FHU.js";import{H as de}from"./HistogramCell-CBujXJtL.js";import{g as le}from"./ChartCell-CdGzSEf4.js";import{t as A,c as q,A as fe,M as W,C as ue,I as me}from"./main.esm-CraDeAap.js";const z=["chart","histogram","linkify","Base64PNGImageDisplayer","SVGDisplayer"],L=e=>t=>R.jsx("span",{children:e(t)}),$=e=>R.jsx("a",{href:e.value,children:e.value}),U=e=>{const n="data:image/png;base64,"+e.value;return R.jsx("img",{src:n})},J=e=>{const n={__html:e.value};return R.jsx("div",{dangerouslySetInnerHTML:n})};$.__docgenInfo={description:"",methods:[],displayName:"LinkCellRenderer"};U.__docgenInfo={description:"",methods:[],displayName:"Base64PNGDisplayer"};J.__docgenInfo={description:"",methods:[],displayName:"SVGDisplayer"};const be=["#e65036","#e65138","#e75339","#e7553a","#e8563c","#e8583d","#e9593f","#e95b40","#e95c41","#ea5e43","#ea5f44","#eb6046","#eb6247","#ec6349","#ec654a","#ec664b","#ed684d","#ed694e","#ee6a50","#ee6c51","#ee6d52","#ef6f54","#ef7055","#ef7157","#f07358","#f0745a","#f1765b","#f1775d","#f1785e","#f27a5f","#f27b61","#f27c62","#f37e64","#f37f65","#f38067","#f48268","#f4836a","#f4846b","#f5866c","#f5876e","#f5886f","#f58a71","#f68b72","#f68c74","#f68d75","#f78f77","#f79078","#f7917a","#f7937b","#f8947d","#f8957e","#f89780","#f89881","#f99983","#f99a84","#f99c86","#f99d87","#f99e89","#faa08a","#faa18c","#faa28d","#faa38f","#faa590","#fba692","#fba793","#fba995","#fbaa96","#fbab98","#fbac99","#fcae9b","#fcaf9c","#fcb09e","#fcb19f","#fcb3a1","#fcb4a2","#fcb5a4","#fcb7a5","#fdb8a7","#fdb9a8","#fdbaaa","#fdbcac","#fdbdad","#fdbeaf","#fdbfb0","#fdc1b2","#fdc2b3","#fdc3b5","#fdc4b6","#fdc6b8","#fdc7ba","#fdc8bb","#fdcabd","#fdcbbe","#fdccc0","#fdcdc1","#fdcfc3","#fdd0c5","#fdd1c6","#fdd2c8","#fdd4c9","#fdd5cb","#fdd6cc","#fdd7ce","#fdd9d0","#fddad1","#fddbd3","#fddcd4","#fdded6","#fcdfd8","#fce0d9","#fce1db","#fce3dc","#fce4de","#fce5e0","#fce7e1","#fce8e3","#fbe9e5","#fbeae6","#fbece8","#fbede9","#fbeeeb","#faefed","#faf1ee","#faf2f0","#faf3f2","#f9f4f3","#f9f5f5","#f8f6f6","#f7f6f7","#f6f6f8","#f5f5f9","#f4f4f9","#f3f3f9","#f1f2f9","#f0f1f9","#eff0f9","#eeeffa","#edeefa","#ecedfa","#eaecfa","#e9ebfa","#e8eafa","#e7e9fa","#e6e8fa","#e5e7fa","#e3e6fa","#e2e5fa","#e1e4fa","#e0e3fa","#dfe2fb","#dde1fb","#dce0fb","#dbdffb","#dadefb","#d9ddfb","#d7dcfb","#d6dbfb","#d5dafb","#d4d9fb","#d3d8fb","#d1d7fb","#d0d6fb","#cfd5fb","#ced4fb","#cdd3fc","#cbd2fc","#cad1fc","#c9d0fc","#c8cffc","#c6cefc","#c5cdfc","#c4ccfc","#c3cbfc","#c1cafc","#c0c9fc","#bfc8fc","#bdc7fc","#bcc7fc","#bbc6fc","#bac5fc","#b8c4fc","#b7c3fc","#b6c2fc","#b4c1fd","#b3c0fd","#b2bffd","#b0befd","#afbdfd","#aebcfd","#acbbfd","#abbafd","#aab9fd","#a8b8fd","#a7b7fd","#a5b6fd","#a4b5fd","#a3b4fd","#a1b3fd","#a0b2fd","#9eb2fd","#9db1fd","#9bb0fd","#9aaffd","#99aefd","#97adfd","#96acfd","#94abfd","#93aafd","#91a9fd","#90a8fd","#8ea7fd","#8ca6fd","#8ba5fe","#89a4fe","#88a4fe","#86a3fe","#84a2fe","#83a1fe","#81a0fe","#809ffe","#7e9efe","#7c9dfe","#7a9cfe","#799bfe","#779afe","#759afe","#7399fe","#7198fe","#7097fe","#6e96fe","#6c95fe","#6a94fe","#6893fe","#6692fe","#6491fe","#6291fe","#5f90fe","#5d8ffe","#5b8efe","#598dfe","#568cfe","#548bfe","#518afe","#4f8afe","#4c89fe","#4988fe","#4787fe","#4486fe","#4085fe","#3d84fe","#3a83fe","#3683fe","#3282fe","#2e81fe","#2980fe","#247ffe"],ge=["#0488fc","#1089fb","#1789fb","#1d89fa","#228afa","#268af9","#2a8af9","#2e8af8","#318bf7","#348bf7","#378bf6","#3a8cf6","#3c8cf5","#3f8cf5","#418df4","#438df4","#458df3","#488df2","#4a8ef2","#4c8ef1","#4d8ef1","#4f8ff0","#518ff0","#538fef","#5490ee","#5690ee","#5890ed","#5991ed","#5b91ec","#5c91ec","#5e92eb","#5f92ea","#6192ea","#6292e9","#6393e9","#6593e8","#6693e8","#6794e7","#6994e6","#6a94e6","#6b95e5","#6c95e5","#6e95e4","#6f96e4","#7096e3","#7196e3","#7297e2","#7397e1","#7497e1","#7698e0","#7798e0","#7898df","#7999df","#7a99de","#7b99dd","#7c9add","#7d9adc","#7e9adc","#7f9bdb","#809bdb","#819bda","#829cd9","#839cd9","#849cd8","#849dd8","#859dd7","#869dd7","#879ed6","#889ed5","#899ed5","#8a9fd4","#8b9fd4","#8c9fd3","#8ca0d3","#8da0d2","#8ea0d1","#8fa1d1","#90a1d0","#91a1d0","#91a2cf","#92a2ce","#93a2ce","#94a3cd","#95a3cd","#95a3cc","#96a4cc","#97a4cb","#98a4ca","#98a5ca","#99a5c9","#9aa5c9","#9ba6c8","#9ba6c8","#9ca6c7","#9da7c6","#9ea7c6","#9ea7c5","#9fa8c5","#a0a8c4","#a0a9c3","#a1a9c3","#a2a9c2","#a2aac2","#a3aac1","#a4aac1","#a4abc0","#a5abbf","#a6abbf","#a6acbe","#a7acbe","#a8acbd","#a8adbc","#a9adbc","#aaadbb","#aaaebb","#abaeba","#acafb9","#acafb9","#adafb8","#adb0b8","#aeb0b7","#afb0b7","#afb1b6","#b0b1b5","#b1b1b5","#b1b2b4","#b2b2b4","#b2b2b3","#b3b3b2","#b4b3b2","#b4b3b1","#b5b4b1","#b6b4b0","#b7b4af","#b7b5af","#b8b5ae","#b9b5ad","#bab6ad","#bab6ac","#bbb6ac","#bcb7ab","#bcb7aa","#bdb7aa","#beb8a9","#beb8a8","#bfb8a8","#c0b9a7","#c0b9a7","#c1b9a6","#c2baa5","#c2baa5","#c3baa4","#c4bba3","#c4bba3","#c5bba2","#c6bca2","#c6bca1","#c7bca0","#c8bca0","#c8bd9f","#c9bd9e","#cabd9e","#cabe9d","#cbbe9c","#ccbe9c","#ccbf9b","#cdbf9b","#cdbf9a","#cec099","#cfc099","#cfc098","#d0c197","#d1c197","#d1c196","#d2c295","#d2c295","#d3c294","#d4c393","#d4c393","#d5c392","#d5c491","#d6c491","#d7c490","#d7c58f","#d8c58f","#d8c58e","#d9c68d","#dac68d","#dac68c","#dbc78b","#dbc78b","#dcc78a","#dcc889","#ddc889","#dec888","#dec987","#dfc987","#dfc986","#e0ca85","#e0ca85","#e1ca84","#e2cb83","#e2cb83","#e3cc82","#e3cc81","#e4cc80","#e4cd80","#e5cd7f","#e6cd7e","#e6ce7e","#e7ce7d","#e7ce7c","#e8cf7b","#e8cf7b","#e9cf7a","#e9d079","#ead078","#ead078","#ebd177","#ecd176","#ecd176","#edd275","#edd274","#eed273","#eed373","#efd372","#efd371","#f0d470","#f0d46f","#f1d46f","#f1d56e","#f2d56d","#f2d56c","#f3d66c","#f3d66b","#f4d66a","#f5d769","#f5d768","#f6d868","#f6d867","#f7d866","#f7d965","#f8d964","#f8d963","#f9da63","#f9da62","#fada61","#fadb60","#fbdb5f","#fbdb5e","#fcdc5d","#fcdc5d","#fddc5c","#fddd5b","#fedd5a","#fedd59"],K=e=>e==="BLUE_TO_YELLOW"?ge:e==="DIVERGING_RED_WHITE_BLUE"?be:e;function pe(e,n){const t=n.length;if(t===0)return 0;for(let o=0;o<n.length;o++)if(e<=n[o])return o;return e>n[t-1]?t-1:n.length}function he(e){function n(t){var C;const o=K(e.map_name),r={backgroundColor:"inherit"},a=(C=t.context)==null?void 0:C.histogram_stats,c=e.val_column;if(c===void 0||a===void 0)return console.log("66 couldn't find stats_col"),r;const d=a[c];if(d===void 0||d.histogram_bins===void 0)return console.log("69 couldn't find summary_stats"),r;const l=d.histogram_bins;function y(D){const S=pe(D,l),x=Math.round(S/l.length*o.length);return o[x]}const F=e.val_column&&t.data?t.data[e.val_column]:t.value,u=y(F);return{backgroundColor:t.node.rowPinned?"inherit":u}}return{cellStyle:n}}function ye(e){const n=K(e.map_name);function t(o){const r=e.val_column&&o.data?o.data[e.val_column]:o.value;return{backgroundColor:o.node.rowPinned?"inherit":n[r]}}return{cellStyle:t}}function we(e){function n(o){if(o.data===void 0)return{backgroundColor:"inherit"};const r=o.data[e.exist_column],a=r&&r!==null,c=o.node.rowPinned;return{backgroundColor:a&&!c?e.conditional_color:"inherit"}}return{cellStyle:n}}function Ce(e){function n(t){if(t.data===void 0)return{backgroundColor:"inherit"};const o=t.data[e.val_column],r=t.node.rowPinned;return{backgroundColor:o&&!r?o:"inherit"}}return{cellStyle:n}}function De(e){switch(e.color_rule){case"color_map":return he(e);case"color_categorical":return ye(e);case"color_from_column":return Ce(e);case"color_not_null":return we(e)}}W.registerModules([ue]);W.registerModules([me]);const Re="#2196F3",Se={rowSelection:"single",enableCellTextSelection:!0,tooltipShowDelay:0,suppressFieldDotNotation:!0,onRowClicked:e=>{var r;const n=document.getSelection();if(n===null)return;const t=document.createRange(),o=(r=e==null?void 0:e.event)==null?void 0:r.target;o!=null&&(t.selectNodeContents(o),n.removeAllRanges(),n.addRange(t))}},_e=(e,n)=>({...Se,...n||{},onCellClicked:t=>{const o=t.column.getColId();if(!(e===void 0||o===void 0)){const r=t.context.activeCol,a=[o,t.column.colDef.headerName];e(a),t.context.activeCol=a;const c={rowNodes:t.api.getRenderedNodes(),columns:[t.api.getColumn(o),t.api.getColumn(r[0])],force:!0};t.api.refreshCells(c)}}});function Y({data_wrapper:e,df_viewer_config:n,summary_stats_data:t,activeCol:o,setActiveCol:r,outside_df_params:a,error_info:c,max_rows_in_configs:d}){var S,x;const l=p.useMemo(()=>Date.now(),[]),y=5,F=n==null?void 0:n.component_config,u=(S=n==null?void 0:n.extra_grid_config)==null?void 0:S.rowHeight,w=JSON.stringify([y,F,u]),f=p.useMemo(()=>{var v;return Ue(d||e.length,n.pinned_rows.length,n==null?void 0:n.component_config,(v=n==null?void 0:n.extra_grid_config)==null?void 0:v.rowHeight)},[w]),C=["",""],D=((x=n==null?void 0:n.component_config)==null?void 0:x.className)||"ag-theme-alpine-dark";return R.jsxs("div",{className:`df-viewer  ${f.classMode} ${f.inIframe}`,children:[R.jsx("pre",{children:c||""}),R.jsx("div",{style:f.applicableStyle,className:`theme-hanger ${D}`,children:R.jsx(Q,{data_wrapper:e,df_viewer_config:n,summary_stats_data:t||[],activeCol:o||C,setActiveCol:r,outside_df_params:a,renderStartTime:l,hs:f})})]})}function Q({data_wrapper:e,df_viewer_config:n,summary_stats_data:t,activeCol:o,setActiveCol:r,outside_df_params:a,renderStartTime:c,hs:d}){const l=p.useMemo(()=>We(n),[n]);p.useEffect(()=>{try{const s=l.map(m=>m==null?void 0:m.field).filter(Boolean);console.info("[DFViewerInfinite][Cols] fields",s)}catch{}},[l]);const y=p.useMemo(()=>({sortable:!0,type:"rightAligned",cellStyle:s=>{var h;const b=s.column.getColDef().field,g=(h=s.context)==null?void 0:h.activeCol[0];if(!s.node.isRowPinned())return g===b?{background:Re}:{background:"inherit"}},enableCellChangeFlash:!1,cellRendererSelector:ze(n.pinned_rows)}),[n.pinned_rows]),F=$e(t),u={activeCol:o,histogram_stats:F,pinned_rows_config:n.pinned_rows},w=n.pinned_rows,f=p.useMemo(()=>He(t,w||[]),[t,w]);p.useEffect(()=>{try{const s=(w||[]).map(m=>m.primary_key_val);console.info("[DFViewerInfinite][PinnedRows] extracted",{pinnedKeys:s,summaryLen:(t==null?void 0:t.length)||0,topLen:(f==null?void 0:f.length)||0}),console.info("[DFViewerInfinite][PinnedRows] summary first row keys",Object.keys(t&&t[0]?t[0]:{})),(f||[]).length>0&&(console.debug("[DFViewerInfinite][PinnedRows] first row",f[0]),console.info("[DFViewerInfinite][PinnedRows] first row keys",Object.keys(f[0]||{})))}catch{}},[t,w,f]);const C=p.useCallback(s=>{var g,h;const m=JSON.stringify((g=s.context)==null?void 0:g.outside_df_params)||"";return`${String((h=s==null?void 0:s.data)==null?void 0:h.index)}-${m}`},[a]),D=p.useMemo(()=>A.withPart(q).withParams({spacing:5,browserColorScheme:"dark",cellHorizontalPaddingScale:.3,columnBorder:!0,headerRowBorder:!0,headerColumnBorder:!0,headerColumnResizeHandleWidth:0,rowBorder:!1,rowVerticalPaddingScale:.5,wrapperBorder:!1,fontSize:12,dataFontSize:"12px",headerFontSize:14,iconSize:10,backgroundColor:"#121212",oddRowBackgroundColor:"#3f3f3f",headerVerticalPaddingScale:.6}),[]),S=p.useMemo(()=>({..._e(r,n.extra_grid_config),domLayout:d.domLayout,autoSizeStrategy:Ye(l.length),onFirstDataRendered:s=>{console.log(`[DFViewerInfinite] AG-Grid finished rendering at ${new Date().toISOString()}`),console.log(`[DFViewerInfinite] Total render time: ${Date.now()-c}ms`)},columnDefs:l,getRowId:C,rowModelType:"clientSide"}),[l.length,JSON.stringify(l),d,n.extra_grid_config,r,C,a]),x=p.useMemo(()=>e.data_type==="DataSource"?e.datasource:{rowCount:e.length,getRows:s=>{throw console.debug("fake datasource getRows called, unexpected"),new Error("fake datasource getRows called, unexpected")}},[e]),v=p.useMemo(()=>Fe(e,S,d),[e,S,d]),k=p.useRef(null),V=p.useRef(null),G=p.useMemo(()=>{try{return l.map(s=>s==null?void 0:s.field).filter(Boolean)}catch{return[]}},[l]),ae=p.useMemo(()=>{const s=(f||[]).map(b=>G.map(g=>b==null?void 0:b[g])),m=(w||[]).map(b=>b.primary_key_val);return JSON.stringify({k:m,f:G,v:s})},[f,G,w]);return p.useEffect(()=>{var s,m,b,g,h,I,_,T,M;try{const P=(f||[]).map(se=>({...se}));V.current=P,console.info("[DFViewerInfinite][PinnedRows] applying via setGridOption len",(P==null?void 0:P.length)||0),(m=(s=k.current)==null?void 0:s.api)==null||m.setGridOption("pinnedTopRowData",P);const ce=(h=(g=(b=k.current)==null?void 0:b.api)==null?void 0:g.getPinnedTopRowCount)==null?void 0:h.call(g),ie=(M=(T=(_=(I=k.current)==null?void 0:I.api)==null?void 0:_.getPinnedTopRow)==null?void 0:T.call(_,0))==null?void 0:M.data;console.info("[DFViewerInfinite][PinnedRows] after apply count",ce,"first",ie)}catch{}},[ae]),R.jsx(fe,{ref:k,theme:D,loadThemeGoogleFonts:!0,gridOptions:v,defaultColDef:y,datasource:x,columnDefs:l,onGridReady:s=>{var m,b,g,h,I,_;try{console.info("[DFViewerInfinite][PinnedRows] onGridReady apply len",((m=V.current)==null?void 0:m.length)||0),s.api.setGridOption("pinnedTopRowData",V.current||[]);const T=(g=(b=s.api).getPinnedTopRowCount)==null?void 0:g.call(b),M=(_=(I=(h=s.api).getPinnedTopRow)==null?void 0:I.call(h,0))==null?void 0:_.data;console.info("[DFViewerInfinite][PinnedRows] onGridReady current count",T,"first",M)}catch{}},onFirstDataRendered:s=>{var m,b,g,h,I;try{const _=(b=(m=s.api).getPinnedTopRowCount)==null?void 0:b.call(m),T=(I=(h=(g=s.api).getPinnedTopRow)==null?void 0:h.call(g,0))==null?void 0:I.data;console.info("[DFViewerInfinite][PinnedRows] onFirstDataRendered pinned count",_,"first",T)}catch{}},context:{outside_df_params:a,...u}},JSON.stringify(a)||"no-outside-params")}const Fe=(e,n,t)=>{if(e.data_type==="Raw")return{...n,rowData:e.data,suppressNoRowsOverlay:!0};if(e.data_type==="DataSource")return xe(n,t.maxRowsWithoutScrolling);throw new Error(`Unexpected data_wrapper.data_type on  ${e}`)},xe=(e,n)=>({...e,animateRows:!1,onSortChanged:o=>{const r=o.api;console.log("sortChanged",r.getFirstDisplayedRowIndex(),r.getLastDisplayedRowIndex(),o),r.ensureIndexVisible(0)},rowBuffer:20,rowModelType:"infinite",cacheBlockSize:n+50,cacheOverflowSize:0,maxConcurrentDatasourceRequests:3,maxBlocksInCache:0});function Ie({df_data:e,df_viewer_config:n,summary_stats_data:t,activeCol:o,setActiveCol:r}){const c=r||(d=>{console.log("defaultSetColumnFunc",d)});return R.jsx(Y,{data_wrapper:{data_type:"Raw",data:e,length:e.length},df_viewer_config:n,summary_stats_data:t,activeCol:o,setActiveCol:c})}Y.__docgenInfo={description:"",methods:[],displayName:"DFViewerInfinite",props:{data_wrapper:{required:!0,tsType:{name:"union",raw:"DatasourceWrapper | RawDataWrapper",elements:[{name:"DatasourceWrapper"},{name:"RawDataWrapper"}]},description:""},df_viewer_config:{required:!0,tsType:{name:"DFViewerConfig"},description:""},summary_stats_data:{required:!1,tsType:{name:"Array",elements:[{name:"Record",elements:[{name:"string"},{name:"union",raw:"string | number | boolean | any[] | Record<string, any> | null",elements:[{name:"string"},{name:"number"},{name:"boolean"},{name:"Array",elements:[{name:"any"}],raw:"any[]"},{name:"Record",elements:[{name:"string"},{name:"any"}],raw:"Record<string, any>"},{name:"null"}]}],raw:`Record<
    string,
    string | number | boolean | any[] | Record<string, any> | null
>`}],raw:"DFDataRow[]"},description:""},activeCol:{required:!1,tsType:{name:"tuple",raw:"[string, string]",elements:[{name:"string"},{name:"string"}]},description:""},setActiveCol:{required:!0,tsType:{name:"signature",type:"function",raw:"(newCol: [string, string]) => void",signature:{arguments:[{type:{name:"tuple",raw:"[string, string]",elements:[{name:"string"},{name:"string"}]},name:"newCol"}],return:{name:"void"}}},description:""},outside_df_params:{required:!1,tsType:{name:"any"},description:""},error_info:{required:!1,tsType:{name:"string"},description:""},max_rows_in_configs:{required:!1,tsType:{name:"number"},description:""}}};Q.__docgenInfo={description:"",methods:[],displayName:"DFViewerInfiniteInner",props:{data_wrapper:{required:!0,tsType:{name:"union",raw:"DatasourceWrapper | RawDataWrapper",elements:[{name:"DatasourceWrapper"},{name:"RawDataWrapper"}]},description:""},df_viewer_config:{required:!0,tsType:{name:"DFViewerConfig"},description:""},summary_stats_data:{required:!0,tsType:{name:"Array",elements:[{name:"Record",elements:[{name:"string"},{name:"union",raw:"string | number | boolean | any[] | Record<string, any> | null",elements:[{name:"string"},{name:"number"},{name:"boolean"},{name:"Array",elements:[{name:"any"}],raw:"any[]"},{name:"Record",elements:[{name:"string"},{name:"any"}],raw:"Record<string, any>"},{name:"null"}]}],raw:`Record<
    string,
    string | number | boolean | any[] | Record<string, any> | null
>`}],raw:"DFDataRow[]"},description:""},activeCol:{required:!0,tsType:{name:"tuple",raw:"[string, string]",elements:[{name:"string"},{name:"string"}]},description:""},setActiveCol:{required:!0,tsType:{name:"signature",type:"function",raw:"(newCol: [string, string]) => void",signature:{arguments:[{type:{name:"tuple",raw:"[string, string]",elements:[{name:"string"},{name:"string"}]},name:"newCol"}],return:{name:"void"}}},description:""},outside_df_params:{required:!1,tsType:{name:"any"},description:""},renderStartTime:{required:!0,tsType:{name:"any"},description:""},hs:{required:!0,tsType:{name:"HeightStyleI"},description:""}}};Ie.__docgenInfo={description:"",methods:[],displayName:"DFViewer",props:{df_data:{required:!0,tsType:{name:"Array",elements:[{name:"Record",elements:[{name:"string"},{name:"union",raw:"string | number | boolean | any[] | Record<string, any> | null",elements:[{name:"string"},{name:"number"},{name:"boolean"},{name:"Array",elements:[{name:"any"}],raw:"any[]"},{name:"Record",elements:[{name:"string"},{name:"any"}],raw:"Record<string, any>"},{name:"null"}]}],raw:`Record<
    string,
    string | number | boolean | any[] | Record<string, any> | null
>`}],raw:"DFDataRow[]"},description:""},df_viewer_config:{required:!0,tsType:{name:"DFViewerConfig"},description:""},summary_stats_data:{required:!1,tsType:{name:"Array",elements:[{name:"Record",elements:[{name:"string"},{name:"union",raw:"string | number | boolean | any[] | Record<string, any> | null",elements:[{name:"string"},{name:"number"},{name:"boolean"},{name:"Array",elements:[{name:"any"}],raw:"any[]"},{name:"Record",elements:[{name:"string"},{name:"any"}],raw:"Record<string, any>"},{name:"null"}]}],raw:`Record<
    string,
    string | number | boolean | any[] | Record<string, any> | null
>`}],raw:"DFDataRow[]"},description:""},activeCol:{required:!1,tsType:{name:"tuple",raw:"[string, string]",elements:[{name:"string"},{name:"string"}]},description:""},setActiveCol:{required:!1,tsType:{name:"signature",type:"function",raw:"(newCol: [string, string]) => void",signature:{arguments:[{type:{name:"tuple",raw:"[string, string]",elements:[{name:"string"},{name:"string"}]},name:"newCol"}],return:{name:"void"}}},description:""}}};const Te=e=>t=>{if(t.data.index==="histogram")return;const o=t.data[e].toString();return R.jsx("div",{className:"ag-tooltip",children:o})},ve=e=>{if(e===void 0)return{};switch(e.tooltip_type){case"simple":return{tooltipComponent:Te(e.val_column),tooltipField:e.val_column};case"summary_series":return{}}},on=new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:3}),B=e=>t=>{const o=t.value;if(o&&e.max_length&&typeof o=="string")try{return o.slice(0,e.max_length)}catch(r){return console.log("e",r,"val",o),""}return o},Pe=e=>`{ ${i.map(e,(t,o)=>`'${o}': ${E(t)}`).join(",")} }`,X=e=>!!(i.isDate(e)&&isFinite(e.getTime())),ke={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1},Me=e=>{const n=e.toLocaleDateString("en-CA",ke),[t,o]=n.split(",");return`${t} ${o}`},E=e=>e==null?"None":i.isArray(e)?`[ ${e.map(E).join(", ")}]`:i.isBoolean(e)?ee(e):i.isObject(e)?Pe(e):e.toString(),Z=e=>t=>{const o=t.value,r=E(o);return e.max_length?r.slice(0,e.max_length):r},Ne=Z({}),ee=e=>e===!0?"True":e===!1?"False":"",Ve=e=>{const n=e.value;return ee(n)},Ge=e=>{const t=Math.floor(e.max_digits/3)+e.max_digits,o=new Intl.NumberFormat("en-US");return a=>{const c=a.value;return c===null||c===void 0?"":o.format(a.value).padStart(t," ")}},Oe=e=>{const n=new Intl.NumberFormat("en-US",{minimumFractionDigits:e.min_fraction_digits,maximumFractionDigits:e.max_fraction_digits});return t=>{if(t.value===null||t.value===void 0)return"";const o=n.format(t.value);if(i.includes(o,".")){const r=o.split(".")[1],a=e.max_fraction_digits-r.length+o.length;return o.padEnd(a)}else{const r=o.length+e.max_fraction_digits+1;return o.padEnd(r)}}},Ee=e=>n=>{const t=n.value;if(t==null)return"";const o=new Date(t);return X(o)?o.toLocaleDateString(e.locale,e.args):""},Le=e=>{const n=e.value;if(n==null)return"";const t=new Date(n);return X(t)?Me(t):""};function ne(e){switch(e.displayer){case"integer":return Ge(e);case"string":return B(e);case"datetimeDefault":return Le;case"datetimeLocaleString":return Ee(e);case"float":return Oe(e);case"boolean":return Ve;case"obj":return Z(e);default:return B({displayer:"string"})}}function te(e){switch(e.displayer){case"histogram":return de;case"chart":return le(e);case"linkify":return $;case"Base64PNGImageDisplayer":return U;case"boolean_checkbox":return"agCheckboxCellRenderer";case"SVGDisplayer":return J}}function Be(e){return i.includes(z,e.displayer)?void 0:ne(e)}function je(e){const n=Be(e);return n!==void 0?{valueFormatter:n}:i.includes(z,e.displayer)?{cellRenderer:te(e)}:{}}function He(e,n){return i.map(i.map(n,"primary_key_val"),t=>i.find(e,{index:t}))}const Ae=e=>i.has(e,"col_path")?e.field:e.col_name;function oe(e){const n=e.color_map_config?De(e.color_map_config):{};return{field:Ae(e),cellDataType:!1,cellStyle:void 0,...je(e.displayer_args),...n,...ve(e.tooltip_config),...e.ag_grid_specs}}function qe(e){return{headerName:e.header_name,...oe(e)}}const O=(e,n)=>{const t=o=>i.has(o,"col_path")?o.col_path[n]:o.col_name+"!&single"+i.indexOf(e,o).toString();return e.reduce((o,r)=>{const a=t(r),c=o[o.length-1];return!c||t(c[0])!==a?o.push([r]):c.push(r),o},[])};function j(e,n){return console.log("f",e,e.ag_grid_specs),{headerName:e.col_path[n],...oe(e)}}function re(e,n=0){if(e.length==0)throw new Error("f shouldn't be empty");const t=e[0].col_path,o=t[n],r=t.length;if(n==r)throw new Error("something went wrong, level is too deep");const a=n+1;if(r==1){const c={children:i.map(e,d=>j(d,0)),...e[0].ag_grid_specs};return console.log(" colDef from multiIndexColToColDef",c),c}if(a==r-1){const c={headerName:o,children:i.map(e,d=>j(d,a)),...e[0].ag_grid_specs};return console.log(" colDef from multiIndexColToColDef",c),c}else{const c=O(e,a),d={headerName:o,children:i.map(c,l=>re(l,a)),...e[0].ag_grid_specs};return console.log(" colDef from multiIndexColToColDef",d),d}}const H=e=>{if(e.length==0)throw new Error("x shouldn't be empty");if(i.has(e[0],"col_path"))return re(e);if(e.length>1)throw new Error(`for NormalColumnConfig, length should be 1, improperly grouped ${e}`);return qe(e[0])};function N(e,n,t){const o=i.cloneDeep(e);return o[n]===void 0?o[n]=t:(console.log("c",o,n),i.isArray(o[n])?o[n].push(t):o[n]=[o[n],t]),o}function We(e){const r=O(e.left_col_configs,0).map(H).map(u=>N(u,"headerClass","left_col_configs_header")).map(u=>N(u,"cellClass","left_col_configs_cell"));if(r.length>0){const u=r.length-1;r[u]=N(r[u],"headerClass","left_col_configs_header_last"),r[u]=N(r[u],"cellClass","left_col_configs_cell_last")}const a=u=>({...u,pinned:"left"}),c=r.map(a);console.log("lcc3",c);const d=e.column_config,y=O(d,0).map(H);return[...r,...y]}function ze(e){const n={component:L(Ne)};return t=>{var o;if(t.node.rowPinned){const r=i.get(t.node.data,"index");if(r===void 0)return n;const a=i.find(e,{primary_key_val:r});if(a===void 0)return n;const c=a,d=(o=t.column)==null?void 0:o.getColId();if(c.default_renderer_columns===void 0&&d==="index"||i.includes(c.default_renderer_columns,d))return n;const l=te(c.displayer_args);return l===void 0?{component:L(ne(c.displayer_args))}:{component:l}}else return}}function $e(e){const n=i.find(e,{index:"histogram_bins"})||{},t=i.find(e,{index:"histogram_log_bins"})||{},o=i.without(i.union(i.keys(n),i.keys(t)),"index"),r=i.map(o,a=>({histogram_bins:i.get(n,a,[]),histogram_log_bins:i.get(t,a,[])}));return i.zipObject(o,r)}const Ue=(e,n,t,o)=>Ke({numRows:n,pinnedRowLen:e,location:window.location,compC:t,rowHeight:o}),Je=()=>window.vscIPyWidgets!==void 0,Ke=e=>{const{numRows:n,pinnedRowLen:t,location:o,rowHeight:r,compC:a}=e,c=o.host.indexOf("colab.googleusercontent.com")!==-1,d=window.parent!==window,l=window.innerHeight/((a==null?void 0:a.height_fraction)||2),y=(a==null?void 0:a.dfvHeight)||l;console.log("314, ",l,window.innerHeight,(a==null?void 0:a.height_fraction)||2,a==null?void 0:a.dfvHeight,l,y);const F={height:y,overflow:"hidden"},u={minHeight:50,maxHeight:y,overflow:"hidden"},f=Math.floor(y/(r||21)-3),C=n+t<f;console.log("belowMinRows",C,n,t,f);const D=(a==null?void 0:a.shortMode)||C&&r===void 0;console.log("shortMode",D,a==null?void 0:a.shortMode,C,r);const S=d?"inIframe":"";if(c||Je())return{classMode:"regular-mode",domLayout:"normal",applicableStyle:{height:500},inIframe:S,maxRowsWithoutScrolling:f};const x=(a==null?void 0:a.layoutType)||(D?"autoHeight":"normal"),v=D?u:F;return console.log("351 gridUtils",D,u,F),{classMode:D?"short-mode":"regular-mode",domLayout:x,applicableStyle:v,inIframe:S,maxRowsWithoutScrolling:f}},Ye=e=>e<1?{type:"fitProvidedWidth",width:window.innerWidth-100}:{type:"fitCellContents"},rn=A.withPart(q).withParams({spacing:5,browserColorScheme:"dark",cellHorizontalPaddingScale:.3,columnBorder:!0,rowBorder:!1,rowVerticalPaddingScale:.5,wrapperBorder:!1,fontSize:12,dataFontSize:"12px",headerFontSize:14,iconSize:10,backgroundColor:"#181D1F",oddRowBackgroundColor:"#222628",headerVerticalPaddingScale:.6});export{Ie as D,Y as a,on as b,Ae as g,rn as m};
